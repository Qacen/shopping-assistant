# Проект по рекомендации и виртуальной примерке одежды

## Актуальность сферы моды в России и мире

Сфера моды демонстрирует устойчивый рост как в России, так и в мире, оставаясь одной из ключевых отраслей розничной торговли. 

- **В России**: По данным РБК, в 2024 году оборот fashion-сегмента в России достиг 3.6 трлн рублей, что свидетельствует о значительном росте рынка ([РБК](https://www.rbc.ru/industries/news/671fb1589a7947511a928b5a)). Более 50% локальных fashion-компаний отметили рост за последние два года, что подчеркивает восстановление и развитие отрасли после пандемии ([Profashion](https://profashion.ru/business/retail/rost-za-poslednie-2-goda-otmetili-bolee-50-lokalnykh-fashion-kompaniy/)).
- **В мире**: Глобальная индустрия моды в 2023 году показала устойчивый рост, несмотря на экономические вызовы, такие как инфляция и изменения потребительских предпочтений. Компании активно инвестируют в цифровизацию, включая персонализированные рекомендации и виртуальные примерки, чтобы удерживать клиентов ([vc.ru](https://vc.ru/id1900584/705267-sostoyanie-industrii-mody-v-2023-godu-uderzhanie-rosta-v-usloviyah-sgushayushihsya-tuch)).

**Актуальность проекта**:
- **Цель проекта**: Создание мобильного приложения для рекомендации элементов одежды, подбора аутфитов и виртуальной примерки с использованием генеративных моделей.
- **Решаемые проблемы**: 
  - Отсутствие персонализированных рекомендаций одежды, учитывающих индивидуальные предпочтения пользователей.
  - Ограниченный доступ к качественным датасетам с пользовательским фидбэком для обучения рекомендательных систем.
  - Необходимость удобного интерфейса для виртуальной примерки, повышающего вовлеченность пользователей.
- **Аргументы актуальности**:
  - Растущий спрос на персонализацию в fashion-индустрии, подкрепленный цифровизацией.
  - Увеличение объемов онлайн-продаж одежды, что требует инновационных решений для улучшения пользовательского опыта.
  - Потенциал интеграции с брендами и крупными платформами, такими как банки, для монетизации.
- **Целевая аудитория и заказчики**:
  - **Потребители**: Люди, покупающие одежду онлайн, желающие получать персонализированные рекомендации и виртуально примерять одежду.
  - **Заказчики**: 
    - Fashion-бренды, готовые платить процент с продаж за интеграцию рекомендаций и виртуальной примерки.
    - Крупные компании (например, Т-Банк), которые могут выкупить продукт или использовать его как программное обеспечение как услугу (SaaS).

## Анализ существующих решений и сравнение с предлагаемым решением

Существующие решения в области рекомендаций и виртуальной примерки одежды включают следующие подходы:

1. **OutfitNet ([+](http://yusanlin.com/files/papers/www20_OutfitNet.pdf))**:
   - **Описание**: OutfitNet — это система рекомендаций аутфитов, использующая глубокое обучение для подбора совместимых элементов одежды. Она основана на анализе визуальных и текстовых данных для создания гармоничных образов.
   - **Особенности**:
     - Использует сверточные нейронные сети (CNN) для извлечения визуальных признаков.
     - Применяет графовые модели для учета совместимости элементов одежды.
     - Обучается на датасетах с изображениями и метаданными одежды.
   - **Ограничения**:
     - Ориентирована на рекомендации, но не включает функционал виртуальной примерки.
     - Требует больших объемов данных для обучения, что ограничивает адаптивность к новым трендам.
     - Не учитывает пользовательский фидбэк в реальном времени.

2. **Lamoda**  — один из ключевых игроков в области персонализированных рекомендаций в fashion-индустрии в России. Основные аспекты их работы:
  - **Персонализированные рекомендации**:
    - Реализуют товарные рекомендации, рекомендации в корзине и рекомендации размеров.
    - Применяют сегментацию пользователей для персонализированной коммуникации, что позволяет адаптировать предложения под конкретные группы клиентов.
  
- **Подбор комплектов (образов)**:
  - Развивают модели для подбора гармоничных комплектов одежды, основываясь на визуальной сочетаемости по фотографиям.
  - Генерируют комплекты на основе текстовых запросов пользователей, что позволяет учитывать их предпочтения в стиле.
  
- **Развитие LLM**:
  - Внедряют LLM, которые поддерживают диалог, дают рекомендации по стилю и помогают в навигации по каталогу товаров.
  - Это добавляет интерактивности, позволяя пользователям получать советы в формате чат-бота.

- **Ограничения**:
  - Отсутствует функционал виртуальной примерки



**Преимущества моего решения**:
- 1) Комбинирование рекомендации элементов одежды, подбор аутфитов и виртуальную примерку в одном приложении.
- 2) Сбор пользовательского фидбэка (лайки/дизлайки) позволяет улучшать рекомендации
- 3) Планируется внедрение мультимодального агента с RAG  для предоставления модных советов, что повысит интерактивность.
- 4) Разработка ориентирована на мобильное приложение, что удобно для конечных пользователей.

## Описание MVP

Для создания минимально жизнеспособного продукта (MVP) реализован следующий функционал:
1. Сбор фидбэка пользователей (лайк/дизлайк) на случайные элементы одежды.
2. Рекомендация аутфитов для элементов, отмеченных лайком.
3. Возможность виртуальной примерки элемента одежды на пользовательском фото.

**Техническая реализация**:
- **Рекомендации**: Подбор образа осуществляется с использованием модели `marqo-fashionSigLIP (finetune)`. Код находится в ноутбуке `clip.ipynb`.
- **Виртуальная примерка**: Реализована с помощью Gemini с возмонжостью генерации изображений
- **Метрики производительности**:

## Формулы метрик `acc@k`

Метрика `acc@k` (accuracy at k) измеряет долю случаев, когда правильный элемент находится среди топ-k рекомендаций. Формула определяется как:

\text{acc@k} = \frac{\text{Количество случаев, где правильный элемент в топ-k}}{\text{Общее количество тестовых примеров}}

Для каждой метрики `acc@k` из предоставленных данных (например, `acc@1`, `acc@5`, `acc@25`, `acc@100`) значение отражает вероятность того, что правильная рекомендация находится в первых k результатах.

**Пример интерпретации:**
- `acc@1 = 0.0076` означает, что в 0.76% случаев правильный элемент оказался первым в списке рекомендаций.
- `acc@100 = 0.2133` означает, что в 21.33% случаев правильный элемент оказался в топ-100 рекомендаций.

| Модель | acc@1 | acc@5 | acc@25 | acc@100 |
| --- | --- | --- | --- | --- |
| **finetuned internvl3-8B + gte-large-en-v1.5** | 0.0012 | 0.0057 | 0.0214 | 0.0682 |
| **finetuned internvl3-8B + marqo-fashionSigLIP** | 0.0011 | 0.0055 | 0.0222 | 0.0771 |
| **marqo-fashionSigLIP (без обучения)** | 0.0046 | 0.0113 | 0.0302 | 0.0769 |
| **marqo-fashionSigLIP (finetune)** | 0.0076 | 0.0264 | 0.0884 | 0.2133 |

## План дальнейшей работы

1. **Улучшение рекомендаций**:
   - VLM плохо выявляют закономерности в рекомендациях даже после дообучения и требуют значительных ресурсов. Планируется разработка мультимодального агента для предоставления советов по одежде с использованием RAG на основе собранных данных. 
   - CLIP хорошо обучается на triplet loss, но стоит протестировать другие архитектуры и функции потерь, а также собрать свой датасет (в открытом доступе крайне мало качественных, я использовал polyvore, но и там много неточностей, есть хорошие датасеты, но они все приватные, парсить данные с сайтов плохая идея, накладываются ошибки моделей и рекомендации могут быть таргетированными), стоит добавить, что я делил трейн, вал и тест так, что никакой индекс в этих частях не пересекается (в том числе и в списках релевантных), еще интересна статья, GNN очень хорошо проявляют себя в этой задаче ([transformers based on GNN](https://arxiv.org/pdf/2304.08098))
   - Проблема: Отсутствие качественных открытых датасетов с пользовательским фидбэком. Решение: Сбор фидбэка пользователей для обучения мультимодальной рекомендательной системы. 
   - Создание модели, которая совмещает персональные предпочтения пользователя и гармонию образа, планируется обучить multimodal rec sys на архитектуре GNN (они очень хорошо показывают себя еще и на задачах рекомендации), вот пример такой модели ([freedom](https://arxiv.org/pdf/2211.06924))


2. **Виртуальная примерка**:
   - Задача virtual try-on будет решаться с использованием специализированных моделей вместо Gemini. Планируется интеграция и дообучение таких моделей. Недавно вышла крутая статья от ([alibaba](https://arxiv.org/pdf/2504.17414)), там показывается подобная модель, но уже с видео

3. **Ресурсы и проблемы**:
   - **Обучение**: Kaggle позволяет бесплатно обучать даже VLM с 8 млрд параметров. Главная проблема — качество данных, для чего потребуется привлечение экспертов в моде.
   - **Хостинг**: Необходимы ресурсы для хостинга моделей и мобильного приложения.
   - **Интерфейс**: Проект ориентирован на мобильное приложение, что обеспечит удобство для пользователей по сравнению с десктопным MVP, будут привлечены kotlin разработчики, для создания интерфейса на android
   - **синтетические данные**: polyvore почти полностью состоит из студийных изображений, мой пайлпайн невелирует это, так как клип не взаимодействует внешними изображениями, но это сильно урезает возможности в рекомендации одежды

Вся работа выполнена единолично Андроновым Станиславом Олеговичем. Участники команды из Сириуса или другие лица не оказывали помощь в работе, проделанной в этом репозитории.